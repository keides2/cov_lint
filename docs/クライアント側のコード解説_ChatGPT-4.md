### 1. 拡張機能の起動とコマンドの設定

この拡張機能は、VSCodeが起動されると自動的に有効化されます。右クリックメニューに`'genie-like.refactoring'`というコマンドが登録され、コードリファクタリングのためのChatGPTモデルを呼び出すことができます。

### 2. APIキーの取得

拡張機能は設定からAPIキーを取得します。`getConfiguration`メソッドを使用して、'genie-like'設定から'apiKey'プロパティを取得します。

### 3. コマンドの実行

`'genie-like.refactoring'`コマンドが実行されると:

- APIキーの存在を確認します。
- 現在アクティブなテキストエディタを取得し、全コンテンツを取得します。
- ChatGPTモデル用のプロンプトを構築し、リファクタリングするコードを含めます。

### 4. ChatGPTとの対話

コードはChatGPTモデル用のプロンプトを構築し、OpenAI APIに対してPOSTリクエストを送信します。
ChatGPTからの応答は処理され、リファクタリングされたコードが取得されます。

### 5. リファクタリングされたコードの表示

リファクタリングされたコードが新しいテキストドキュメントで開かれます。
オリジナルのコードとリファクタリングされたコードは、'vscode.diff'コマンドを使用して並べて表示されます。

### 6. 言語サーバーの初期化

言語クライアントは、この拡張機能に関連する言語サーバーと通信するために初期化されます。
言語クライアントのオプションとして、ドキュメントの選択、診断の収集などが指定されます。

### 7. サブスクリプションの設定

この拡張機能は、登録されたコマンドや言語クライアントなど、さまざまなコンポーネントにサブスクライブします。
